<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Manager Picker Wheel</title>
  <style>
    :root{
      --bg: #f3f4f6;      /* gray-100 */
      --card: #ffffff;    /* white */
      --text: #0f172a;    /* slate-900 */
      --muted:#475569;    /* slate-600 */
      --line: #e5e7eb;    /* gray-200 */
      --rail: #facc15;    /* amber-400 */
      --rail-dark:#f59e0b;/* amber-500 */
      --active-bg:#eef2ff;/* indigo-100 */
      --active-br:#c7d2fe;/* indigo-200 */
      --active-tx:#1e40af;/* indigo-800 */
    }
    *{ box-sizing: border-box; }
    html, body{ margin:0; height:100%; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }

    header{ position: sticky; top:0; z-index:10; background: var(--card); border-bottom:1px solid var(--line); }
    .bar{ max-width: 1500px; margin: 0 auto; display:flex; gap:12px; align-items:center; padding: 10px 14px; }
    .brand{ font-weight:800; letter-spacing:.2px; font-size:14px; opacity:.9; }
    .brand a{ color: inherit; text-decoration: none; }
    nav{ display:flex; gap:6px; }
    nav a{ color:#334155; text-decoration:none; font-size:13px; padding:6px 10px; border-radius:8px; border:1px solid transparent; }
    nav a[aria-current="page"]{ background: var(--active-bg); border-color: var(--active-br); color: var(--active-tx); }
    .spacer{ flex:1; }

    .main-content{
      display:flex; gap:40px; padding:30px;
      justify-content: center;
      min-height: calc(100vh - 60px);
      align-items: flex-start;
    }
    .wheel-wrap{ display:flex; flex-direction:column; align-items:center; }
    #wheel{ width:600px; height:600px; border:8px solid var(--card); border-radius:50%; box-shadow:0 4px 12px rgba(0,0,0,.2); cursor:pointer; }
    #result{ margin-top:18px; font-weight:800; color:var(--active-tx); }
    .editor{ display:flex; flex-direction:column; }
    .editor h3{ margin:0 0 10px 0; color: var(--text); }
    #players{
      width:260px; font:14px/1.4 monospace; padding:8px; resize:none; overflow:hidden;
      border:1px solid var(--line); border-radius:8px; background:var(--card);
    }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand"><a href="home.html">Rayo Vilkins FC</a></div>
      <div class="spacer"></div>
      <nav>
        <a href="matches.html">Matches</a>
        <a href="stats.html">Stats</a>
        <a href="wheel.html" aria-current="page">Wheel</a>
      </nav>
    </div>
  </header>

  <div class="main-content">
    <div class="wheel-wrap">
      <canvas id="wheel" width="600" height="600"></canvas>
      <div id="result">Click the wheel to pick a Manager</div>
    </div>

    <div class="editor">
      <h3>Edit Players</h3>
      <textarea id="players"></textarea>
    </div>
  </div>

<script>
(function(){
  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const resultEl = document.getElementById('result');
  const inputEl = document.getElementById('players');

  // Starter list (your original names + Wandrinho)
  let players = [
    "Wheaterz9","Durzonate","PeterSSS","Shootyk1nz","rv-Doggie",
    "07_DoctorWho","Brixrainman","geter006","DerBones","Wandrinho"
  ];
  inputEl.value = players.join('\n');

  // auto-resize the textarea to fit content
  function autoResize(){
    inputEl.style.height = 'auto';
    inputEl.style.height = inputEl.scrollHeight + 'px';
  }
  autoResize();

  // Drawing state
  const R = canvas.width / 2;
  const POINTER_ANGLE = Math.PI; // left-pointing arrow
  let angle = 0; // current rotation (radians)
  let spinning = false;

  function normalize(a){
    a = a % (2*Math.PI);
    return a < 0 ? a + 2*Math.PI : a;
  }

  function drawWheel(){
    const n = Math.max(players.length, 1);
    const step = (2*Math.PI) / n;

    ctx.clearRect(0,0,canvas.width,canvas.height);

    // slices + labels
    for(let i=0;i<n;i++){
      const start = angle + i*step;
      const end   = start + step;

      // slice
      ctx.beginPath();
      ctx.moveTo(R,R);
      ctx.arc(R,R,R, start, end);
      ctx.fillStyle = i%2===0 ? '#fbbf24' : '#f59e0b'; // amber/orange alternation
      ctx.fill();
      ctx.strokeStyle = '#874f00';
      ctx.lineWidth = 1;
      ctx.stroke();

      // text (inward, near rim)
      ctx.save();
      ctx.translate(R,R);
      const mid = start + step/2;

      // Position text near the rim, facing inward
      const MARGIN_FROM_RIM = 80;              // more space to prevent clipping
      const x = R - MARGIN_FROM_RIM;
      ctx.rotate(mid);
      ctx.translate(x,0);
      ctx.rotate(Math.PI);                     // face inward

      // Adjust font size for longer names
      const name = players[i] ?? '';
      const len  = name.length;
      const fontSize = len > 14 ? 16 : len > 10 ? 18 : 20;

      ctx.fillStyle = '#000';
      ctx.font = `bold ${fontSize}px "Segoe UI", sans-serif`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(name, 0, 0);
      ctx.restore();
    }

    // left-side pointer (blue)
    ctx.fillStyle = 'blue';
    ctx.beginPath();
    ctx.moveTo(0, R-16);
    ctx.lineTo(0, R+16);
    ctx.lineTo(34, R);
    ctx.closePath();
    ctx.fill();
  }

  function easeOut(t){ return 1 - Math.pow(1 - t, 3); }

  function spin(){
    if(spinning || players.length === 0) return;
    spinning = true;

    const spinMs = 2500;                                  // faster
    const spinAngle = Math.random()*Math.PI*8 + Math.PI*10;
    const start = angle;
    const t0 = performance.now();

    function frame(t){
      const p = Math.min((t - t0)/spinMs, 1);
      angle = start + spinAngle * easeOut(p);
      drawWheel();
      if(p < 1){ requestAnimationFrame(frame); }
      else{
        spinning = false;
        angle = normalize(angle);
        showWinner();
      }
    }
    requestAnimationFrame(frame);
  }

  // Winner is the slice whose mid-angle is at the pointer (left).
  function showWinner(){
    const n = players.length;
    const step = (2*Math.PI)/n;

    // Convert pointer to the frame where slice 0 starts at 0 when angle=0
    const local = normalize(POINTER_ANGLE - angle);   // [0, 2Ï€)
    // Each slice covers [i*step, (i+1)*step). Use floor to get the index.
    let idx = Math.floor(local / step);
    if (idx < 0) idx = 0;
    if (idx > n-1) idx = n-1;

    const winner = players[idx] ?? '';
    resultEl.textContent = `Manager: ${winner}`;
  }

  // Events
  canvas.addEventListener('click', spin);

  inputEl.addEventListener('input', () => {
    players = inputEl.value.split('\n').map(s=>s.trim()).filter(Boolean);
    autoResize();
    // keep angle, just redraw (winner will be based on new list after next spin)
    drawWheel();
  });

  // initial paint
  drawWheel();
})();
</script>
</body>
</html>